-- 1
create database assignment_6;
-- 2
create table locations(
    location_id serial primary key,
    street_address varchar(25),
    postal_code varchar(12),
    city varchar(30),
    state_province varchar(12)
);
create table departments(
    department_id serial primary key,
    department_name varchar(50) unique,
    budget integer,
    city varchar(30),
    location_id integer references locations
);
create table employees(
    employee_id serial primary key,
    first_name varchar(50),
    last_name varchar(50),
    email varchar(50),
    phone_number varchar(50),
    salary integer,
    department_id integer references departments
);
-- 3
insert into locations values ('1', '143 Abay', '050000', 'Almaty', 'Almaty');
insert into locations values ('2', '45 Satpaev', '050003', 'Almaty', 'Almaty');
insert into locations values ('3', '75 Mangilik el', '010010', 'Astana', 'Aqmola');
insert into locations values ('4', '170/4 Tauke khan', '160011', 'Shymkent', 'Turkistan');
insert into locations values ('5', '59 Tole bi', '050000', 'Almaty', 'Almaty');

insert into departments values ('30', 'Abdi', '15000000', 'Almaty', '1');
insert into departments values ('50', 'Almaty Towers', '350000000', 'Almaty', '2');
insert into departments values ('60', 'School 75', '87000000', 'Astana', '3');
insert into departments values ('70', 'Sandyq', '130000000', 'Shymkent', '4');
insert into departments values ('80', 'KBTU', '200000000', 'Almaty', '5');

insert into employees values ('111', 'Gabit', 'Serikov', 'gabit@gmail.com', '87077077711', '300000', '30');
insert into employees values ('112', 'Berik', 'Erbolatov', 'berik@gmail.com', '87767575751', '500000', '50');
insert into employees values ('113', 'Zhaniya', 'Amanova', 'zhaniya@gmail.com', '87478088811', '350000', '60');
insert into employees values ('114', 'Quat', 'Zhanabilov', 'quar@gmail.com', '87754562215', '1000000', '70');
insert into employees values ('115', 'Aqmaral', 'Seifulla', 'aqmaral@gmail.com', '87277073731', '800000', '80');
-- drop table employees, departments, locations;
-- 4. Select the first name, last name, department id, and department name for each employee.

select employees.first_name, employees.last_name, employees.department_id, departments.department_name
from employees
inner join departments on departments.department_id = employees.department_id;

-- 5. Select the first name, last name, department id and department name, for all employees for departments 80 or 30.

select employees.first_name, employees.last_name, employees.department_id, departments.department_name
from employees
inner join departments on departments.department_id = employees.department_id
where departments.department_id = '30' or departments.department_id = '80';

-- 6. Select the first and last name, department, city, and state province for each employee.

select employees.first_name, employees.last_name, departments.department_name, locations.state_province
from employees
inner join departments on departments.department_id = employees.department_id
inner join locations on departments.location_id = locations.location_id;

-- 7. Select all departments including those where does not have any employee.
select departments.department_name
from departments
left join employees on departments.department_id = employees.department_id

-- 8. Select the first name, last name, department id and name, for all employees who have or have not any department.
select employees.first_name, employees.last_name, employees.department_id, departments.department_name
from employees
left join departments on employees.department_id = departments.department_id ;

-- 9. Select the employee last name, first name, who works in Moscow.

select employees.last_name, employees.first_name
from employees
inner join departments on departments.department_id = employees.department_id
where departments.city = 'Moscow';